{
    "Version": "2019-10-30",
    "StartAction": "856dd865-e5a0-49c6-aacc-55fe53c38a22",
    "Metadata": {
        "entryPointPosition": {
            "x": 20,
            "y": 18.4
        },
        "ActionMetadata": {
            "410057d0-9390-486b-bbb4-c4def2a7367c": {
                "position": {
                    "x": 506.4,
                    "y": 325.6
                }
            },
            "856dd865-e5a0-49c6-aacc-55fe53c38a22": {
                "position": {
                    "x": 185.6,
                    "y": 14.4
                }
            },
            "d5bd7724-4436-4bfc-bd2a-d0bee26963a1": {
                "position": {
                    "x": 430.4,
                    "y": 16
                }
            },
            "3f9659a3-56a5-4f3c-a431-fd9da2306459": {
                "position": {
                    "x": 354.4,
                    "y": 557.6
                }
            },
            "99458f47-6941-48ce-9b90-fdf184759b22": {
                "position": {
                    "x": 788.8,
                    "y": 644.8
                }
            },
            "07273109-a75a-4742-aaae-ce35603c31fc": {
                "position": {
                    "x": 97.6,
                    "y": 868
                }
            },
            "6728609a-9707-41f7-a87c-30ac1fde4f4c": {
                "position": {
                    "x": 128.8,
                    "y": 213.6
                },
                "toCustomer": true,
                "fromCustomer": true
            },
            "97a964a7-5dd2-4c82-b21f-173b209be8a7": {
                "position": {
                    "x": 101.6,
                    "y": 609.6
                },
                "dynamicMetadata": {}
            },
            "Deepgram Configuration": {
                "position": {
                    "x": 100.8,
                    "y": 424
                },
                "isFriendlyName": true,
                "dynamicParams": []
            }
        },
        "Annotations": [
            {
                "type": "default",
                "id": "1eea972b-aa90-4eff-82ee-3ab7c0fec95c",
                "content": "Configure Deepgram through contact attributes. We can use any parameters available through the Deepgram streaming API. \n\nFor example, we can set \"model=nova\" by setting a contact attribute with key \"model\" and value \"nova\". We can set \"tag=sometag1&tag=sometag2\" by setting a contact attribute with key \"tag\" and value \"sometag1 sometag2\".\n\nThe \"callback\" parameter is where Deepgram will send transcripts. Within this parameter, we can inject the Contact ID of the current call. For example, set key \"callback\" and value \"https://www.example.com/some/path/{contact-id}\"",
                "actionId": "Deepgram Configuration",
                "isFolded": true,
                "position": {
                    "x": 145.16666666666666,
                    "y": 736.6666666666666
                },
                "size": {
                    "height": 295,
                    "width": 300
                }
            }
        ],
        "name": "Sample Deepgram flow",
        "description": "",
        "type": "contactFlow",
        "status": "published",
        "hash": {}
    },
    "Actions": [
        {
            "Parameters": {
                "Text": "An error occurred when we tried to start streaming."
            },
            "Identifier": "410057d0-9390-486b-bbb4-c4def2a7367c",
            "Type": "MessageParticipant",
            "Transitions": {
                "NextAction": "99458f47-6941-48ce-9b90-fdf184759b22"
            }
        },
        {
            "Parameters": {
                "FlowLoggingBehavior": "Enabled"
            },
            "Identifier": "856dd865-e5a0-49c6-aacc-55fe53c38a22",
            "Type": "UpdateFlowLoggingBehavior",
            "Transitions": {
                "NextAction": "d5bd7724-4436-4bfc-bd2a-d0bee26963a1"
            }
        },
        {
            "Parameters": {
                "SSML": "<speak>\nThis call demonstrates real time transcription with Deepgram. We'll now begin sending call audio to Deepgram.\n<break time=\"500ms\"/>\n</speak>"
            },
            "Identifier": "d5bd7724-4436-4bfc-bd2a-d0bee26963a1",
            "Type": "MessageParticipant",
            "Transitions": {
                "NextAction": "6728609a-9707-41f7-a87c-30ac1fde4f4c",
                "Errors": [
                    {
                        "NextAction": "99458f47-6941-48ce-9b90-fdf184759b22",
                        "ErrorType": "NoMatchingError"
                    }
                ]
            }
        },
        {
            "Parameters": {
                "Text": "An error occurred with inoking the Deepgram lambda function."
            },
            "Identifier": "3f9659a3-56a5-4f3c-a431-fd9da2306459",
            "Type": "MessageParticipant",
            "Transitions": {
                "NextAction": "99458f47-6941-48ce-9b90-fdf184759b22",
                "Errors": [
                    {
                        "NextAction": "99458f47-6941-48ce-9b90-fdf184759b22",
                        "ErrorType": "NoMatchingError"
                    }
                ]
            }
        },
        {
            "Parameters": {},
            "Identifier": "99458f47-6941-48ce-9b90-fdf184759b22",
            "Type": "DisconnectParticipant",
            "Transitions": {}
        },
        {
            "Parameters": {
                "SSML": "<speak>\nThis call is now being transcribed by Deepgram.\n<break time=\"1000ms\"/>\nTo demonstrate please tell me what city you are from?\n<break time=\"5000ms\"/>\nHow is the weather?\n<break time=\"5000ms\"/>\nThanks for using our solution. Goodbye.\n</speak>"
            },
            "Identifier": "07273109-a75a-4742-aaae-ce35603c31fc",
            "Type": "MessageParticipant",
            "Transitions": {
                "NextAction": "99458f47-6941-48ce-9b90-fdf184759b22",
                "Errors": [
                    {
                        "NextAction": "99458f47-6941-48ce-9b90-fdf184759b22",
                        "ErrorType": "NoMatchingError"
                    }
                ]
            }
        },
        {
            "Parameters": {
                "MediaStreamingState": "Enabled",
                "MediaStreamType": "Audio",
                "Participants": [
                    {
                        "ParticipantType": "Customer",
                        "MediaDirections": [
                            "To",
                            "From"
                        ]
                    }
                ]
            },
            "Identifier": "6728609a-9707-41f7-a87c-30ac1fde4f4c",
            "Type": "UpdateContactMediaStreamingBehavior",
            "Transitions": {
                "NextAction": "Deepgram Configuration",
                "Errors": [
                    {
                        "NextAction": "410057d0-9390-486b-bbb4-c4def2a7367c",
                        "ErrorType": "NoMatchingError"
                    }
                ]
            }
        },
        {
            "Parameters": {
                "LambdaFunctionARN": "arn:aws:lambda:us-east-1:126597142151:function:pd-test-3-kvsConsumerTrigger-1VMZGG6KHAFPB",
                "InvocationTimeLimitSeconds": "8",
                "ResponseValidation": {
                    "ResponseType": "STRING_MAP"
                }
            },
            "Identifier": "97a964a7-5dd2-4c82-b21f-173b209be8a7",
            "Type": "InvokeLambdaFunction",
            "Transitions": {
                "NextAction": "07273109-a75a-4742-aaae-ce35603c31fc",
                "Errors": [
                    {
                        "NextAction": "3f9659a3-56a5-4f3c-a431-fd9da2306459",
                        "ErrorType": "NoMatchingError"
                    }
                ]
            }
        },
        {
            "Parameters": {
                "Attributes": {
                    "tag": "sometag1 sometag2",
                    "model": "nova",
                    "callback": "https://www.example.com/some/path/{contact-id}"
                },
                "TargetContact": "Current"
            },
            "Identifier": "Deepgram Configuration",
            "Type": "UpdateContactAttributes",
            "Transitions": {
                "NextAction": "97a964a7-5dd2-4c82-b21f-173b209be8a7",
                "Errors": [
                    {
                        "NextAction": "97a964a7-5dd2-4c82-b21f-173b209be8a7",
                        "ErrorType": "NoMatchingError"
                    }
                ]
            }
        }
    ]
}